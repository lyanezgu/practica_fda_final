ggplot(data=top_10_caras, mapping = aes(x = reorder(codigo_enf,-mean),mean)) + geom_bar(stat = "identity", aes(fill=mean)) + theme_bw(base_size=9) + ylab("Media Total Payments") + xlab("Codigo enfermedad") + ggtitle("10 enfermedadas más caras") + scale_y_continuous(label = scales::dollar) + scale_fill_gradient(low="light blue", high="dodgerblue4")
test <- top_10_caras %>% inner_join(train)
test
ggplot(test, aes(codigo_enf,prov_state, fill=cobertura))+geom_tile() + theme_bw(base_size=7) + scale_fill_gradient(low = "white", high = "purple")
library(PerformanceAnalytics)
cor(x=train$mean_total_payments, y=train$mean_medicare_payments)
with(train, plot(x=mean_total_payments, y=mean_medicare_payments, pch=20, col='blue',
xlab='mean total payments', las=1,
ylab='mean_medicare_payments'))
library(dplyr)
library(ggplot2)
train %>% ggplot(aes(mean_total_payments, mean_medicare_payments)) +
geom_point(alpha=0.2, colour="green") +
geom_smooth(formula= 'y ~ x',method = 'lm') +
labs(title='Relacion entre variables total payments y medicare payments',
x='mean total payments',
y='mean medicare payments`')
# ver si el mean total payments sigue una normal
train%>%
filter(mean_total_payments<100000 ) %>%
ggplot(aes(x=mean_total_payments))+ geom_histogram()
# ver si el mean total payments sigue una normal
train%>%
filter(mean_total_payments<100000 ) %>%
ggplot(aes(x=log10(mean_total_payments)))+ geom_histogram()
# ver si el mean total payments sigue una normal
train%>%
filter(mean_medicare_payments<100000 ) %>%
ggplot(aes(x=mean_medicare_payments))+ geom_histogram()
# ver si el mean total payments sigue una normal
train%>%
filter(mean_medicare_payments<100000 ) %>%
ggplot(aes(x=log10(mean_medicare_payments)))+ geom_histogram()
# ver si el mean total payments sigue una normal
train%>%
filter(mean_medicare_payments<100000 ) %>%
ggplot(aes(x=copagos))+ geom_histogram()
# ver si el mean total payments sigue una normal
train%>%
filter(mean_medicare_payments<100000 ) %>%
ggplot(aes(x=log10(copagos)))+ geom_histogram()
#train %>% select(1:14) %>%
#  na.omit() %>%
#  ggpairs(columns = 1:13, ggplot2::aes(colour=group),cardinality_threshold=50000)
train_num <- Filter(is.numeric, train)
train_num
p1 <- ggplot (train_num, aes(y= train_num$mean_total_payments)) + geom_boxplot(fill = "red") + scale_y_continuous(name = "dólares", labels = scales::dollar) + xlab("mean_total_payments") + ggtitle("Boxplot: mean_total_payments")
p11 <- ggplot (train_num, aes(y= log10(train_num$mean_total_payments))) + geom_boxplot(fill = "red") + scale_y_continuous(name = " Log dólares", labels = scales::dollar) + xlab("mean_total_payments") + ggtitle("Boxplot: Log mean_total_payments")
plot_grid(p1, p11)
mean(train_num$mean_total_payments)
p2 <- ggplot (train_num, aes(y=train_num$mean_medicare_payments)) + geom_boxplot(fill = "blue") + scale_y_continuous(name = "dólares", labels = scales::dollar) + xlab("mean_medicare_payments") + ggtitle("Boxplot: mean_medicare_payments")
p22 <- ggplot (train_num, aes(y= log10(train_num$mean_medicare_payments))) + geom_boxplot(fill = "blue") + scale_y_continuous(name = "Log dólares", labels = scales::dollar) + xlab("mean_medicare_payments") + ggtitle("Boxplot: Log mean_medicare_payments")
plot_grid(p2, p22)
mean(train_num$mean_medicare_payments)
p3 <- ggplot (train_num, aes(y=train_num$copagos)) + geom_boxplot(fill = "yellow") + scale_y_continuous(name = "dólares", labels = scales::dollar) + xlab("copagos") + ggtitle("Boxplot: copagos")
p33 <- ggplot (train_num, aes(y=log10(train_num$copagos))) + geom_boxplot(fill = "yellow") + scale_y_continuous(name = "Log dólares", labels = scales::dollar) + xlab("copagos") + ggtitle("Boxplot: Log copagos")
plot_grid(p3, p33)
mean(train_num$copagos)
p4 <- ggplot (train_num, aes(y=train_num$cobertura)) + geom_boxplot(fill = "green") + scale_y_continuous(name = "% cobertura") + xlab("cobertura") + ggtitle("Boxplot: cobertura")
p4
mean(train_num$cobertura)
#https://rstudio-pubs-static.s3.amazonaws.com/386777_ce8f66f8a49a403da721af05d06b2804.html
#pairs(train_num)
#summary(train_num)
#cor(x=train$copagos,y=train$mean_total_payments,method = "pearson")
#str(train_num)
res <- cor(train_num)
round(res, 2)
corrplot(res, type = "upper", order = "hclust",
tl.col = "black", tl.srt = 45)
##ggpairs(train, lower = list(continuous = "smooth"),
##        diag = list(continuous = "bar"), axisLabels = "none", cardinality_threshold=5000)
#pairs(x = train_num)
ggplot(data = train, mapping=aes(x = categoria_enf, y = log10(copagos), color=categoria_enf)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme_bw() + theme(legend.position = "none")
library(MASS)
#attach(train)
ggplot(train, aes(x=codigo_enf, y=mean_total_payments, color=prov_state)) +
geom_point() + theme_light()
#https://fhernanb.github.io/libro_regresion/varcuali.html
modelo= lm(copagos~mean_medicare_payments+categoria_enf,data=train)
#coef(modelo)
summary(modelo)
modelo= lm(copagos~categoria_state+mean_medicare_payments+categoria_enf,data=train)
#coef(modelo)
summary(modelo)
knitr::opts_chunk$set(echo = TRUE)
library(formatR)
library(readr)
library(ggplot2)
library(GGally)
library(dplyr)
library(tidyr)
library(missForest)
library(VIM)
library(formattable)
library(usmap)
library(cowplot)
library(corrplot)
hospital_charges <- read_csv("notebooks/hospital-charges.csv")
hospital_charges
head(hospital_charges)
summary(hospital_charges)
#cambio de nombres de las variables
names(hospital_charges) <- c('drg_def', 'prov_id', 'prov_name', 'prov_address', 'prov_city', 'prov_state', 'prov_zip','hospital_ref', 'total_discharges','mean_covered_charges', 'mean_total_payments', 'mean_medicare_payments')
head(hospital_charges)
hospital_charges$mean_covered_charges = as.numeric(gsub("\\$","",hospital_charges$mean_covered_charges))
hospital_charges$mean_total_payments = as.numeric(gsub("\\$","",hospital_charges$mean_total_payments))
hospital_charges$mean_medicare_payments = as.numeric(gsub("\\$","",hospital_charges$mean_medicare_payments))
hospital_charges$prov_zip = as.factor(hospital_charges$prov_zip)
hospital_charges$prov_id = as.factor(hospital_charges$prov_id)
head(hospital_charges)
str(hospital_charges)
hospital_charges
set.seed(101)
hospital_charges <-bind_cols(hospital_charges[c(1,2,3,4,5,6,7,8,11,12)],
missForest::prodNA(hospital_charges[c(-1,-2,-3,-4,-5,-6,-7,-8,-11,-12)],noNA=0.1))
hospital_charges
summary(aggr(hospital_charges,numbers=T,sortVar=T))
#referencia https://rpubs.com/sediaz/na_aggr
set.seed(101)
sample <- sample.int(n=nrow(hospital_charges), size=floor(.80*nrow(hospital_charges)), replace = F)
train <- hospital_charges[sample,]
test <- hospital_charges[-sample,]
train
test
#remplaza los valores faltantes de las columnas seegun valores medios de las mismas
train$mean_covered_charges[is.na(train$mean_covered_charges)]<-mean(train$mean_covered_charges,na.rm = TRUE)
train$total_discharges[is.na(train$total_discharges)]<-mean(train$total_discharges,na.rm = TRUE)
train <-train %>%
separate(data = ., col = drg_def,
into = c("codigo_enf", "desc_enf"), sep = "-")
train$codigo_enf <- as.factor(train$codigo_enf)
train
str(train)
train <- train %>% mutate(copagos = mean_total_payments - mean_medicare_payments)
train
train <- train %>% mutate(cobertura = percent(mean_medicare_payments/mean_total_payments))
train
#creamos variable grupo de estados por copagos
train <- train %>% group_by(prov_state) %>%
mutate(mean_total_state=mean(mean_total_payments))
train
#creamos variable grupo de enfermedades por copago
train <- train %>% group_by(codigo_enf) %>%
mutate(mean_total_enf=mean(mean_total_payments))
summary(train)
#nueva variable agrupando estados por media de copagos
train<-train %>%
mutate(categoria_state = case_when(mean_total_state >= 10300  ~ 'High',
mean_total_state >= 8900 ~ 'Mid',
TRUE ~ 'Low'))
train
ggplot(train)+geom_bar(aes(x=categoria_state))
#nueva variable agrupando enfermedades por media de copagos
train<-train %>%
mutate(categoria_enf = case_when(mean_total_enf >= 11000 ~ 'High',
mean_total_enf >= 6000 ~ 'Mid',
TRUE ~ 'Low'))
train
ggplot(train)+geom_bar(aes(x=categoria_enf))
#Haciendo la media de lo que cobra el hospital por estado
region_geog <- train %>% group_by(prov_state) %>% summarise (mean_total_price = mean(copagos))
region_geog
#Libreria usmap tiene el mapa de EEUU por estado
library(usmap)
statepop #en libreria usmap hay un dataframe que es la populacion para cada estado
#(siglas -abbr ) y nos interesa agrupar a este data frame la columna mean_total_payments
names(statepop) <- c('fips','prov_state','full','pop_2015') #cambiamos el nombre de la
#columna abbr para prov_state para tenerla igual en statepop y region_geog
statepop <- statepop %>% left_join(region_geog, by='prov_state') #juntamos region_geog y statepop
plot_usmap(data = statepop, values = "mean_total_price", color = "white") +
scale_fill_continuous(low='light blue', high ='dark blue',name = "Media Copagos", label = scales::comma) +
theme(legend.position = "right")
d2 <- train %>%
count(codigo_enf) %>%
top_n(10) %>%
arrange(n, codigo_enf) %>%
mutate(codigo_enf = factor(codigo_enf, levels = unique(codigo_enf)))
train %>%
filter(codigo_enf %in% d2$codigo_enf) %>%
mutate(codigo_enf = factor(codigo_enf, levels = levels(d2$codigo_enf))) %>%
ggplot(aes(x = codigo_enf, fill=desc_enf)) + geom_bar() + coord_flip() +
theme_bw(base_size=9) + xlab("Código enfermedad") +
ylab("Frecuencia") +
ggtitle("10 enfermedadas más comunes")
d3 <- train %>%
group_by(codigo_enf) %>% summarise(mean=mean(mean_total_payments)) %>% arrange(desc(mean))
top_10_caras <- head(d3,10)
top_10_caras
ggplot(data=top_10_caras, mapping = aes(x = reorder(codigo_enf,-mean),mean)) + geom_bar(stat = "identity", aes(fill=mean)) + theme_bw(base_size=9) + ylab("Media Total Payments") + xlab("Codigo enfermedad") + ggtitle("10 enfermedadas más caras") + scale_y_continuous(label = scales::dollar) + scale_fill_gradient(low="light blue", high="dodgerblue4")
test <- top_10_caras %>% inner_join(train)
test
ggplot(test, aes(codigo_enf,prov_state, fill=cobertura))+geom_tile() + theme_bw(base_size=7) + scale_fill_gradient(low = "white", high = "purple")
library(PerformanceAnalytics)
cor(x=train$mean_total_payments, y=train$mean_medicare_payments)
with(train, plot(x=mean_total_payments, y=mean_medicare_payments, pch=20, col='blue',
xlab='mean total payments', las=1,
ylab='mean_medicare_payments'))
library(dplyr)
library(ggplot2)
train %>% ggplot(aes(mean_total_payments, mean_medicare_payments)) +
geom_point(alpha=0.2, colour="green") +
geom_smooth(formula= 'y ~ x',method = 'lm') +
labs(title='Relacion entre variables total payments y medicare payments',
x='mean total payments',
y='mean medicare payments`')
# ver si el mean total payments sigue una normal
train%>%
filter(mean_total_payments<100000 ) %>%
ggplot(aes(x=mean_total_payments))+ geom_histogram()
# ver si el mean total payments sigue una normal
train%>%
filter(mean_total_payments<100000 ) %>%
ggplot(aes(x=log10(mean_total_payments)))+ geom_histogram()
# ver si el mean total payments sigue una normal
train%>%
filter(mean_medicare_payments<100000 ) %>%
ggplot(aes(x=mean_medicare_payments))+ geom_histogram()
# ver si el mean total payments sigue una normal
train%>%
filter(mean_medicare_payments<100000 ) %>%
ggplot(aes(x=log10(mean_medicare_payments)))+ geom_histogram()
# ver si el mean total payments sigue una normal
train%>%
filter(mean_medicare_payments<100000 ) %>%
ggplot(aes(x=copagos))+ geom_histogram()
# ver si el mean total payments sigue una normal
train%>%
filter(mean_medicare_payments<100000 ) %>%
ggplot(aes(x=log10(copagos)))+ geom_histogram()
#train %>% select(1:14) %>%
#  na.omit() %>%
#  ggpairs(columns = 1:13, ggplot2::aes(colour=group),cardinality_threshold=50000)
train_num <- Filter(is.numeric, train)
train_num
p1 <- ggplot (train_num, aes(y= train_num$mean_total_payments)) + geom_boxplot(fill = "red") + scale_y_continuous(name = "dólares", labels = scales::dollar) + xlab("mean_total_payments") + ggtitle("Boxplot: mean_total_payments")
p11 <- ggplot (train_num, aes(y= log10(train_num$mean_total_payments))) + geom_boxplot(fill = "red") + scale_y_continuous(name = " Log dólares", labels = scales::dollar) + xlab("mean_total_payments") + ggtitle("Boxplot: Log mean_total_payments")
plot_grid(p1, p11)
mean(train_num$mean_total_payments)
p2 <- ggplot (train_num, aes(y=train_num$mean_medicare_payments)) + geom_boxplot(fill = "blue") + scale_y_continuous(name = "dólares", labels = scales::dollar) + xlab("mean_medicare_payments") + ggtitle("Boxplot: mean_medicare_payments")
p22 <- ggplot (train_num, aes(y= log10(train_num$mean_medicare_payments))) + geom_boxplot(fill = "blue") + scale_y_continuous(name = "Log dólares", labels = scales::dollar) + xlab("mean_medicare_payments") + ggtitle("Boxplot: Log mean_medicare_payments")
plot_grid(p2, p22)
mean(train_num$mean_medicare_payments)
p3 <- ggplot (train_num, aes(y=train_num$copagos)) + geom_boxplot(fill = "yellow") + scale_y_continuous(name = "dólares", labels = scales::dollar) + xlab("copagos") + ggtitle("Boxplot: copagos")
p33 <- ggplot (train_num, aes(y=log10(train_num$copagos))) + geom_boxplot(fill = "yellow") + scale_y_continuous(name = "Log dólares", labels = scales::dollar) + xlab("copagos") + ggtitle("Boxplot: Log copagos")
plot_grid(p3, p33)
mean(train_num$copagos)
p4 <- ggplot (train_num, aes(y=train_num$cobertura)) + geom_boxplot(fill = "green") + scale_y_continuous(name = "% cobertura") + xlab("cobertura") + ggtitle("Boxplot: cobertura")
p4
mean(train_num$cobertura)
#https://rstudio-pubs-static.s3.amazonaws.com/386777_ce8f66f8a49a403da721af05d06b2804.html
#pairs(train_num)
#summary(train_num)
#cor(x=train$copagos,y=train$mean_total_payments,method = "pearson")
#str(train_num)
res <- cor(train_num)
round(res, 2)
corrplot(res, type = "upper", order = "hclust",
tl.col = "black", tl.srt = 45)
##ggpairs(train, lower = list(continuous = "smooth"),
##        diag = list(continuous = "bar"), axisLabels = "none", cardinality_threshold=5000)
#pairs(x = train_num)
ggplot(data = train, mapping=aes(x = categoria_enf, y = log10(copagos), color=categoria_enf)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme_bw() + theme(legend.position = "none")
library(MASS)
#attach(train)
ggplot(train, aes(x=codigo_enf, y=mean_total_payments, color=prov_state)) +
geom_point() + theme_light()
#https://fhernanb.github.io/libro_regresion/varcuali.html
modelo= lm(copagos~categoria_state+mean_medicare_payments+categoria_enf,data=train)
#coef(modelo)
summary(modelo)
ggplot(data = train, mapping=aes(x = categoria_state, y = log10(copagos), color=categoria_state)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme_bw() + theme(legend.position = "none")
modelo= lm(copagos~categoria_state+mean_medicare_payments+categoria_enf+total_discharges,data=train)
#coef(modelo)
summary(modelo)
knitr::opts_chunk$set(echo = TRUE)
library(formatR)
library(readr)
library(ggplot2)
library(GGally)
library(dplyr)
library(tidyr)
library(missForest)
library(VIM)
library(formattable)
library(usmap)
library(cowplot)
library(corrplot)
hospital_charges <- read_csv("notebooks/hospital-charges.csv")
hospital_charges
head(hospital_charges)
summary(hospital_charges)
#cambio de nombres de las variables
names(hospital_charges) <- c('drg_def', 'prov_id', 'prov_name', 'prov_address', 'prov_city', 'prov_state', 'prov_zip','hospital_ref', 'total_discharges','mean_covered_charges', 'mean_total_payments', 'mean_medicare_payments')
head(hospital_charges)
hospital_charges$mean_covered_charges = as.numeric(gsub("\\$","",hospital_charges$mean_covered_charges))
hospital_charges$mean_total_payments = as.numeric(gsub("\\$","",hospital_charges$mean_total_payments))
hospital_charges$mean_medicare_payments = as.numeric(gsub("\\$","",hospital_charges$mean_medicare_payments))
hospital_charges$prov_zip = as.factor(hospital_charges$prov_zip)
hospital_charges$prov_id = as.factor(hospital_charges$prov_id)
head(hospital_charges)
str(hospital_charges)
hospital_charges
set.seed(101)
hospital_charges <-bind_cols(hospital_charges[c(1,2,3,4,5,6,7,8,11,12)],
missForest::prodNA(hospital_charges[c(-1,-2,-3,-4,-5,-6,-7,-8,-11,-12)],noNA=0.1))
hospital_charges
summary(aggr(hospital_charges,numbers=T,sortVar=T))
#referencia https://rpubs.com/sediaz/na_aggr
set.seed(101)
sample <- sample.int(n=nrow(hospital_charges), size=floor(.80*nrow(hospital_charges)), replace = F)
train <- hospital_charges[sample,]
test <- hospital_charges[-sample,]
train
test
#remplaza los valores faltantes de las columnas seegun valores medios de las mismas
train$mean_covered_charges[is.na(train$mean_covered_charges)]<-mean(train$mean_covered_charges,na.rm = TRUE)
train$total_discharges[is.na(train$total_discharges)]<-mean(train$total_discharges,na.rm = TRUE)
train <-train %>%
separate(data = ., col = drg_def,
into = c("codigo_enf", "desc_enf"), sep = "-")
train$codigo_enf <- as.factor(train$codigo_enf)
train
str(train)
train <- train %>% mutate(copagos = mean_total_payments - mean_medicare_payments)
train
train <- train %>% mutate(cobertura = percent(mean_medicare_payments/mean_total_payments))
train
#creamos variable grupo de estados por copagos
train <- train %>% group_by(prov_state) %>%
mutate(mean_total_state=mean(mean_total_payments))
train
#creamos variable grupo de enfermedades por copago
train <- train %>% group_by(codigo_enf) %>%
mutate(mean_total_enf=mean(mean_total_payments))
summary(train)
#nueva variable agrupando estados por media de copagos
train<-train %>%
mutate(categoria_state = case_when(mean_total_state >= 10300  ~ 'High',
mean_total_state >= 8900 ~ 'Mid',
TRUE ~ 'Low'))
train
ggplot(train)+geom_bar(aes(x=categoria_state))
#nueva variable agrupando enfermedades por media de copagos
train<-train %>%
mutate(categoria_enf = case_when(mean_total_enf >= 11000 ~ 'High',
mean_total_enf >= 6000 ~ 'Mid',
TRUE ~ 'Low'))
train
ggplot(train)+geom_bar(aes(x=categoria_enf))
#Haciendo la media de lo que cobra el hospital por estado
region_geog <- train %>% group_by(prov_state) %>% summarise (mean_total_price = mean(copagos))
region_geog
#Libreria usmap tiene el mapa de EEUU por estado
library(usmap)
statepop #en libreria usmap hay un dataframe que es la populacion para cada estado
#(siglas -abbr ) y nos interesa agrupar a este data frame la columna mean_total_payments
names(statepop) <- c('fips','prov_state','full','pop_2015') #cambiamos el nombre de la
#columna abbr para prov_state para tenerla igual en statepop y region_geog
statepop <- statepop %>% left_join(region_geog, by='prov_state') #juntamos region_geog y statepop
plot_usmap(data = statepop, values = "mean_total_price", color = "white") +
scale_fill_continuous(low='light blue', high ='dark blue',name = "Media Copagos", label = scales::comma) +
theme(legend.position = "right")
d2 <- train %>%
count(codigo_enf) %>%
top_n(10) %>%
arrange(n, codigo_enf) %>%
mutate(codigo_enf = factor(codigo_enf, levels = unique(codigo_enf)))
train %>%
filter(codigo_enf %in% d2$codigo_enf) %>%
mutate(codigo_enf = factor(codigo_enf, levels = levels(d2$codigo_enf))) %>%
ggplot(aes(x = codigo_enf, fill=desc_enf)) + geom_bar() + coord_flip() +
theme_bw(base_size=9) + xlab("Código enfermedad") +
ylab("Frecuencia") +
ggtitle("10 enfermedadas más comunes")
d3 <- train %>%
group_by(codigo_enf) %>% summarise(mean=mean(mean_total_payments)) %>% arrange(desc(mean))
top_10_caras <- head(d3,10)
top_10_caras
ggplot(data=top_10_caras, mapping = aes(x = reorder(codigo_enf,-mean),mean)) + geom_bar(stat = "identity", aes(fill=mean)) + theme_bw(base_size=9) + ylab("Media Total Payments") + xlab("Codigo enfermedad") + ggtitle("10 enfermedadas más caras") + scale_y_continuous(label = scales::dollar) + scale_fill_gradient(low="light blue", high="dodgerblue4")
test <- top_10_caras %>% inner_join(train)
test
ggplot(test, aes(codigo_enf,prov_state, fill=cobertura))+geom_tile() + theme_bw(base_size=7) + scale_fill_gradient(low = "white", high = "purple")
library(PerformanceAnalytics)
cor(x=train$mean_total_payments, y=train$mean_medicare_payments)
with(train, plot(x=mean_total_payments, y=mean_medicare_payments, pch=20, col='blue',
xlab='mean total payments', las=1,
ylab='mean_medicare_payments'))
library(dplyr)
library(ggplot2)
train %>% ggplot(aes(mean_total_payments, mean_medicare_payments)) +
geom_point(alpha=0.2, colour="green") +
geom_smooth(formula= 'y ~ x',method = 'lm') +
labs(title='Relacion entre variables total payments y medicare payments',
x='mean total payments',
y='mean medicare payments`')
# ver si el mean total payments sigue una normal
train%>%
filter(mean_total_payments<100000 ) %>%
ggplot(aes(x=mean_total_payments))+ geom_histogram()
# ver si el mean total payments sigue una normal
train%>%
filter(mean_total_payments<100000 ) %>%
ggplot(aes(x=log10(mean_total_payments)))+ geom_histogram()
# ver si el mean total payments sigue una normal
train%>%
filter(mean_medicare_payments<100000 ) %>%
ggplot(aes(x=mean_medicare_payments))+ geom_histogram()
# ver si el mean total payments sigue una normal
train%>%
filter(mean_medicare_payments<100000 ) %>%
ggplot(aes(x=log10(mean_medicare_payments)))+ geom_histogram()
# ver si el mean total payments sigue una normal
train%>%
filter(mean_medicare_payments<100000 ) %>%
ggplot(aes(x=copagos))+ geom_histogram()
# ver si el mean total payments sigue una normal
train%>%
filter(mean_medicare_payments<100000 ) %>%
ggplot(aes(x=log10(copagos)))+ geom_histogram()
#train %>% select(1:14) %>%
#  na.omit() %>%
#  ggpairs(columns = 1:13, ggplot2::aes(colour=group),cardinality_threshold=50000)
train_num <- Filter(is.numeric, train)
train_num
p1 <- ggplot (train_num, aes(y= train_num$mean_total_payments)) + geom_boxplot(fill = "red") + scale_y_continuous(name = "dólares", labels = scales::dollar) + xlab("mean_total_payments") + ggtitle("Boxplot: mean_total_payments")
p11 <- ggplot (train_num, aes(y= log10(train_num$mean_total_payments))) + geom_boxplot(fill = "red") + scale_y_continuous(name = " Log dólares", labels = scales::dollar) + xlab("mean_total_payments") + ggtitle("Boxplot: Log mean_total_payments")
plot_grid(p1, p11)
mean(train_num$mean_total_payments)
p2 <- ggplot (train_num, aes(y=train_num$mean_medicare_payments)) + geom_boxplot(fill = "blue") + scale_y_continuous(name = "dólares", labels = scales::dollar) + xlab("mean_medicare_payments") + ggtitle("Boxplot: mean_medicare_payments")
p22 <- ggplot (train_num, aes(y= log10(train_num$mean_medicare_payments))) + geom_boxplot(fill = "blue") + scale_y_continuous(name = "Log dólares", labels = scales::dollar) + xlab("mean_medicare_payments") + ggtitle("Boxplot: Log mean_medicare_payments")
plot_grid(p2, p22)
mean(train_num$mean_medicare_payments)
p3 <- ggplot (train_num, aes(y=train_num$copagos)) + geom_boxplot(fill = "yellow") + scale_y_continuous(name = "dólares", labels = scales::dollar) + xlab("copagos") + ggtitle("Boxplot: copagos")
p33 <- ggplot (train_num, aes(y=log10(train_num$copagos))) + geom_boxplot(fill = "yellow") + scale_y_continuous(name = "Log dólares", labels = scales::dollar) + xlab("copagos") + ggtitle("Boxplot: Log copagos")
plot_grid(p3, p33)
mean(train_num$copagos)
p4 <- ggplot (train_num, aes(y=train_num$cobertura)) + geom_boxplot(fill = "green") + scale_y_continuous(name = "% cobertura") + xlab("cobertura") + ggtitle("Boxplot: cobertura")
p4
mean(train_num$cobertura)
#https://rstudio-pubs-static.s3.amazonaws.com/386777_ce8f66f8a49a403da721af05d06b2804.html
#pairs(train_num)
#summary(train_num)
#cor(x=train$copagos,y=train$mean_total_payments,method = "pearson")
#str(train_num)
res <- cor(train_num)
round(res, 2)
corrplot(res, type = "upper", order = "hclust",
tl.col = "black", tl.srt = 45)
##ggpairs(train, lower = list(continuous = "smooth"),
##        diag = list(continuous = "bar"), axisLabels = "none", cardinality_threshold=5000)
#pairs(x = train_num)
ggplot(data = train, mapping=aes(x = categoria_state, y = log10(copagos), color=categoria_state)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme_bw() + theme(legend.position = "none")
library(MASS)
#attach(train)
ggplot(train, aes(x=codigo_enf, y=mean_total_payments, color=prov_state)) +
geom_point() + theme_light()
#https://fhernanb.github.io/libro_regresion/varcuali.html
modelo= lm(copagos~categoria_state+mean_medicare_payments+categoria_enf+total_discharges,data=train)
#coef(modelo)
summary(modelo)
modelo= lm(copagos~categoria_state+mean_medicare_payments+categoria_enf+total_discharges+
mean_covered_charges,data=train)
#coef(modelo)
summary(modelo)
modelo= lm(copagos~categoria_state+mean_medicare_payments+categoria_enf+total_discharges+
mean_covered_charges+cobertura,data=train)
#coef(modelo)
summary(modelo)
modelo= lm(copagos~categoria_state+categoria_enf+total_discharges+
mean_covered_charges+cobertura,data=train)
#coef(modelo)
summary(modelo)
modelo= lm(copagos~categoria_state+categoria_enf+total_discharges+cobertura,data=train)
#coef(modelo)
summary(modelo)
modelo= lm(copagos~categoria_state+categoria_enf+total_discharges+cobertura
+mean_medicare_payments,data=train)
#coef(modelo)
summary(modelo)
modelo= lm(copagos~categoria_state+categoria_enf+total_discharges+cobertura
+mean_total_payments,data=train)
#coef(modelo)
summary(modelo)
modelo= lm(copagos~categoria_state+categoria_enf+cobertura
+mean_total_payments,data=train)
#coef(modelo)
summary(modelo)
modelo= lm(copagos~categoria_state+categoria_enf+total_discharges+cobertura
+mean_total_payments,data=train)
#coef(modelo)
summary(modelo)
modelo= lm(copagos~categoria_state+categoria_enf+total_discharges+cobertura
+mean_total_payments,data=train)
#coef(modelo)
summary(modelo)
modelo= lm(copagos~categoria_state+categoria_enf+cobertura
+mean_total_payments,data=train)
#coef(modelo)
summary(modelo)
